import{a as S,b as T,E as I,o as p,c as b,r as l,d as r,w as a,e as q,f as h,g as m,h as B,p as R,i as F,j as N,k as v,l as U,m as j,n as M,q as H,s as K,t as z,u as W,z as G,v as X,x as Y}from"./vendor.db57384a.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))d(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&d(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function d(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const J={login:"/login",getDomainList:"/getDomainList",addDomain:"/addDomain",getDomainById:"/getDomainById",deleteDomainById:"/deleteDomainById",updateDomainById:"/updateDomainById",updateDomainCertInfoById:"/updateDomainCertInfoById",updateAllDomainCertInfoOfUser:"/updateAllDomainCertInfoOfUser",importDomainFromFile:"/importDomainFromFile",getAllDomainListOfUser:"/getAllDomainListOfUser",sendDomainInfoListEmail:"/sendDomainInfoListEmail",checkDomainCert:"/checkDomainCert",getAllSystemConfig:"/getAllSystemConfig",updateSystemConfig:"/updateSystemConfig",getUserInfo:"/getUserInfo",updateUserInfo:"/updateUserInfo",updateUserPassword:"/updateUserPassword",getUserList:"/getUserList",addUser:"/addUser",deleteUser:"/deleteUser",updateUserStatus:"/updateUserStatus",getLogSchedulerList:"/getLogSchedulerList"},C="token";function Q(e){S.set(C,e,{expires:7})}function $(){return S.get(C)}function Z(){S.remove(C)}const E="/api",k=T.create({baseURL:E});k.interceptors.request.use(e=>{let t=$();return t&&(e.headers["X-Token"]=t),e},e=>{console.log(e)});k.interceptors.response.use(e=>e.data,e=>{console.log(e)});function ee(e){return async function(t={},n){let d=null;t instanceof FormData,d=t;const s=await k.post(e,d,n);return s.code!=0&&I.error(s.msg),s}}function te(){let e={};for(let[t,n]of Object.entries(J))e[t]=ee(n);return e}const L=te();function Me(e){return E+e}class se{static message(t){return I.closeAll(),I(t)}static success(t){return this.message({message:t,type:"success"})}static warning(t){return this.message({message:t,type:"warning"})}static info(t){return this.message({message:t,type:"info"})}static error(t){return this.message({message:t,type:"error"})}static closeAll(){I.closeAll()}}const oe="modulepreload",ne=function(e){return"/"+e},V={},y=function(t,n,d){return!n||n.length===0?t():Promise.all(n.map(s=>{if(s=ne(s),s in V)return;V[s]=!0;const o=s.endsWith(".css"),i=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${i}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":oe,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((u,_)=>{c.addEventListener("load",u),c.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t())},g=(e,t)=>{const n=e.__vccOpts||e;for(const[d,s]of t)n[d]=s;return n},re={name:"admin",props:{},components:{},data(){return{}},computed:{},methods:{async getData(){}},created(){this.getData()}},ae={class:""};function ie(e,t,n,d,s,o){return p(),b("div",ae," admin ")}const le=g(re,[["render",ie]]);const de={name:"Login",props:{},components:{},data(){return{form:{username:"",password:""},rules:{username:[{required:!0,message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{required:!0,message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}}},computed:{},methods:{async getData(){},onSubmit(){this.$refs.form.validate(e=>{if(e)this.confirmSubmit();else return!1})},async confirmSubmit(){const e=await this.$http.login({username:this.form.username,password:this.form.password});if(console.log(e),e.code==0){Q(e.data.token),this.$msg.success("\u767B\u5F55\u6210\u529F");let t="/";this.$route.query.redirect&&(t=this.$route.query.redirect),this.$router.push({path:t})}}},created(){this.getData()}},ce=e=>(R("data-v-5e777eed"),e=e(),F(),e),ue={class:"login-container"},me=ce(()=>h("h3",{class:"title"},"\u767B\u5F55",-1));function pe(e,t,n,d,s,o){const i=l("el-input"),c=l("el-form-item"),u=l("el-form"),_=l("el-button");return p(),b("div",ue,[me,r(u,{class:"",ref:"form",model:s.form,rules:s.rules,"label-width":"auto"},{default:a(()=>[r(c,{label:"",prop:"username"},{default:a(()=>[r(i,{modelValue:s.form.username,"onUpdate:modelValue":t[0]||(t[0]=f=>s.form.username=f),"auto-complete":"off",placeholder:"\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),r(c,{label:"",prop:"password"},{default:a(()=>[r(i,{modelValue:s.form.password,"onUpdate:modelValue":t[1]||(t[1]=f=>s.form.password=f),type:"password","auto-complete":"off",placeholder:"\u5BC6\u7801",onKeypress:q(o.onSubmit,["enter"])},null,8,["modelValue","onKeypress"])]),_:1})]),_:1},8,["model","rules"]),h("div",null,[r(_,{class:"w-full",type:"primary",size:"large",onClick:B(o.onSubmit,["prevent"])},{default:a(()=>[m("\u767B \u5F55")]),_:1},8,["onClick"])])])}const fe=g(de,[["render",pe],["__scopeId","data-v-5e777eed"]]),D=N({id:"user-store",state:()=>({_userInfo:null}),getters:{hasUserInfo:e=>e._userInfo!=null,isAdmin:e=>{if(e._userInfo)return e._userInfo.username=="admin"},userInfo:e=>e._userInfo},actions:{async updateUserInfo(){const e=await L.getUserInfo();e.code==0&&(this._userInfo=e.data)},removeUserInfo(){this._userInfo=null}}}),_e={password:[{message:"\u65E7\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],new_password:[{message:"\u65B0\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}]},he={name:"",props:{row:{type:Object,default:null}},components:{},data(){return{form:{password:"",new_password:""},rules:_e}},computed:{},methods:{async getData(){if(this.row){let e={id:this.row.id};const t=await this.$http.function(e);if(t.code!=0)return;let n=t.data;this.form.password=n.password,this.form.new_password=n.new_password}},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(e=>{if(e)this.confirmSubmit();else return!1})},async confirmSubmit(){let e=this.$loading({fullscreen:!0}),t={password:this.form.password,new_password:this.form.new_password};const n=await this.$http.updateUserPassword(t);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg),this.$nextTick(()=>{e.close()})}},created(){this.getData()}},ge={class:"text-center"};function we(e,t,n,d,s,o){const i=l("el-input"),c=l("el-form-item"),u=l("el-form"),_=l("el-button");return p(),b("div",null,[r(u,{ref:"form",model:s.form,rules:s.rules,"label-width":"80px"},{default:a(()=>[r(c,{label:"\u65E7\u5BC6\u7801",prop:"password"},{default:a(()=>[r(i,{type:"text",modelValue:s.form.password,"onUpdate:modelValue":t[0]||(t[0]=f=>s.form.password=f),placeholder:"\u8BF7\u8F93\u5165\u65E7\u5BC6\u7801"},null,8,["modelValue"])]),_:1}),r(c,{label:"\u65B0\u5BC6\u7801",prop:"new_password"},{default:a(()=>[r(i,{type:"text",modelValue:s.form.new_password,"onUpdate:modelValue":t[1]||(t[1]=f=>s.form.new_password=f),placeholder:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),h("div",ge,[r(_,{onClick:o.handleCancel},{default:a(()=>[m("\u53D6 \u6D88")]),_:1},8,["onClick"]),r(_,{type:"primary",onClick:o.handleSubmit},{default:a(()=>[m("\u786E \u5B9A")]),_:1},8,["onClick"])])])}const ye=g(he,[["render",we]]),ve={name:"",props:{row:{type:Object,default:null},visible:{type:Boolean,default:!1}},emits:["update:visible"],components:{DataForm:ye},data(){return{dialogVisible:!1}},computed:{dialogTitle(){return this.row?"\u7F16\u8F91":"\u6DFB\u52A0"},dialogVisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}}},methods:{handleClose(){this.$emit("on-cancel")},handleOpen(){},handleSuccess(){this.$emit("on-success")}},created(){}};function be(e,t,n,d,s,o){const i=l("DataForm"),c=l("el-dialog");return p(),v(c,{title:"\u4FEE\u6539\u767B\u5F55\u5BC6\u7801",modelValue:o.dialogVisible,"onUpdate:modelValue":t[0]||(t[0]=u=>o.dialogVisible=u),width:"400px",center:"","append-to-body":""},{default:a(()=>[o.dialogVisible?(p(),v(i,{key:0,row:n.row,onOnCancel:o.handleClose,onOnSuccess:o.handleSuccess},null,8,["row","onOnCancel","onOnSuccess"])):U("",!0)]),_:1},8,["modelValue"])}const Ie=g(ve,[["render",be]]),Ue={name:"Menu",props:{},components:{UserPaswordEditDataFormDailog:Ie},data(){return{activeIndex:"",dialogVisible:!1}},computed:{...j(D,{userInfo:"userInfo",isAdmin:"isAdmin"})},methods:{...M(D,{updateUserInfo:"updateUserInfo",removeUserInfo:"removeUserInfo"}),async getData(){},handleSelect(e){},handleLogoutClick(e){this.removeUserInfo(),Z(),this.$router.push({path:"/login"})},handleUpdatePasswordClick(){this.dialogVisible=!0},handleUserPaswordEditClose(){this.dialogVisible=!1},handleUserPaswordEditSuccess(){this.dialogVisible=!1}},created(){this.activeIndex=this.$route.name,this.getData()}},De={class:""},Se={class:"self-center margin-left--auto flex items-center"},Ce=h("a",{href:"https://github.com/mouday/domain-admin",class:"mr-md",target:"_blank"},[h("img",{alt:"GitHub stars",src:"https://img.shields.io/github/stars/mouday/domain-admin.svg?style=social"})],-1),ke=h("img",{src:"https://api.multiavatar.com/domain-admin.png"},null,-1);function Ve(e,t,n,d,s,o){const i=l("el-menu-item"),c=l("el-avatar"),u=l("el-dropdown-item"),_=l("el-dropdown-menu"),f=l("el-dropdown"),x=l("el-menu"),O=l("UserPaswordEditDataFormDailog");return p(),b("div",De,[r(x,{"default-active":s.activeIndex,ellipsis:!1,class:"el-menu-demo",mode:"horizontal",router:"","menu-trigger":"click",onSelect:o.handleSelect},{default:a(()=>[r(i,{index:"domain-list"},{default:a(()=>[m("\u57DF\u540D\u7BA1\u7406")]),_:1}),r(i,{index:"user-edit"},{default:a(()=>[m("\u4E2A\u4EBA\u8BBE\u7F6E")]),_:1}),e.isAdmin?(p(),v(i,{key:0,index:"user-admin-list"},{default:a(()=>[m("\u7528\u6237\u7BA1\u7406")]),_:1})):U("",!0),e.isAdmin?(p(),v(i,{key:1,index:"system-list"},{default:a(()=>[m("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1})):U("",!0),r(i,{index:"log-scheduler-list"},{default:a(()=>[m("\u76D1\u6D4B\u65E5\u5FD7")]),_:1}),h("div",Se,[Ce,r(f,{trigger:"hover"},{dropdown:a(()=>[r(_,null,{default:a(()=>[r(u,{onClick:o.handleUpdatePasswordClick,class:"justify-center"},{default:a(()=>[m("\u4FEE\u6539\u5BC6\u7801")]),_:1},8,["onClick"]),r(u,{onClick:o.handleLogoutClick,class:"justify-center"},{default:a(()=>[m("\u9000\u51FA")]),_:1},8,["onClick"])]),_:1})]),default:a(()=>[r(c,{src:e.userInfo&&e.userInfo.avatar_url},{default:a(()=>[ke]),_:1},8,["src"])]),_:1})])]),_:1},8,["default-active","onSelect"]),r(O,{visible:s.dialogVisible,"onUpdate:visible":t[0]||(t[0]=A=>s.dialogVisible=A),onOnSuccess:o.handleUserPaswordEditSuccess,onOnCancel:o.handleUserPaswordEditClose},null,8,["visible","onOnSuccess","onOnCancel"])])}const $e=g(Ue,[["render",Ve]]);const Ee={name:"index",props:{},components:{Menu:$e},data(){return{}},computed:{},methods:{async getData(){}},created(){this.getData()}},Le={class:"app-layout"};function Pe(e,t,n,d,s,o){const i=l("Menu"),c=l("router-view");return p(),b("div",Le,[r(i),h("div",null,[r(c)])])}const xe=g(Ee,[["render",Pe]]),Oe=[{path:"/login",component:fe},{path:"/",component:xe,redirect:"/domain-list",children:[{path:"/domain-list",name:"domain-list",component:()=>y(()=>import("./index.aa06d788.js"),["assets/index.aa06d788.js","assets/index.56d6aeba.css","assets/vendor.db57384a.js","assets/ConnectStatus.4fb1b634.js"])},{path:"/system-list",name:"system-list",component:()=>y(()=>import("./index.de409905.js"),["assets/index.de409905.js","assets/vendor.db57384a.js"])},{path:"/user-edit",name:"user-edit",component:()=>y(()=>import("./index.16375f6c.js"),["assets/index.16375f6c.js","assets/vendor.db57384a.js"])},{path:"/user-admin-list",name:"user-admin-list",component:()=>y(()=>import("./index.84a72472.js"),["assets/index.84a72472.js","assets/vendor.db57384a.js"])},{path:"/log-scheduler-list",name:"log-scheduler-list",component:()=>y(()=>import("./index.37c5a2cc.js"),["assets/index.37c5a2cc.js","assets/ConnectStatus.4fb1b634.js","assets/vendor.db57384a.js"])}]},{path:"/admin",component:le}],Ae=["/login"];function Te(e){e.beforeEach(async(t,n,d)=>{let s=$();const o=D();s&&!o.hasUserInfo&&await o.updateUserInfo(),Ae.includes(t.path)||o.hasUserInfo?d():d({path:"/login",query:{redirect:t.fullPath}})})}const P=H({history:K(),routes:Oe});Te(P);const qe=P;const Be={};function Re(e,t){const n=l("router-view");return p(),v(n)}const Fe=g(Be,[["render",Re]]),w=z(Fe);w.config.globalProperties.$http=L;w.config.globalProperties.$msg=se;w.use(qe);w.use(W,{locale:G});for(const[e,t]of Object.entries(X))w.component(e,t);const Ne=Y();w.use(Ne);w.mount("#app");export{g as _,J as d,Me as r,D as u};
