import{d as ne,I as Q,e as le,O as L,a6 as F,a5 as $,T as M,ah as j,L as oe,H as re,u as ce,al as de,a4 as ue,n as me,g as N,f as pe,ag as he,t as fe,l as ve,w as _e,_ as x,E as Y,a as ge,b as be,c as Z,o as we,aj as ye,v as Ce}from"./index.95d3e9d7.js";import{i as Ve,E as ke}from"./el-select.5682ea84.js";import{a as Se,E as De,b as Ee}from"./el-table-column.ae086364.js";/* empty css                */import{j as A,D as Te,h as U,r as R,w as K,f as Ie,o as r,c as v,a as D,u as a,P as w,am as ee,Q as C,R as c,S as z,M as _,V as T,O as q,T as l,W as J,U as Ue,n as Ne,ay as X,e as Oe,aa as H,a1 as O,ap as Be,K as Pe}from"./vendor-vue.03135ea1.js";import{E as ze}from"./el-popover.14b42a05.js";import{l as Fe}from"./element-icon.a70fe67d.js";import"./vendor-lib.1edac35d.js";const xe=ne({modelValue:{type:[Boolean,String,Number],default:!1},value:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},activeIcon:{type:Q},inactiveIcon:{type:Q},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},borderColor:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},id:String,loading:{type:Boolean,default:!1},beforeChange:{type:le(Function)},size:{type:String,validator:Ve},tabindex:{type:[String,Number]}}),$e={[L]:n=>F(n)||A(n)||$(n),[M]:n=>F(n)||A(n)||$(n),[j]:n=>F(n)||A(n)||$(n)},Ae=["onClick"],Re=["id","aria-checked","aria-disabled","name","true-value","false-value","disabled","tabindex","onKeydown"],Ke=["aria-hidden"],Le=["aria-hidden"],Me=["aria-hidden"],je=["aria-hidden"],qe={name:"ElSwitch"},He=Te({...qe,props:xe,emits:$e,setup(n,{expose:i,emit:m}){const o=n,d="ElSwitch",p=Oe(),{formItem:h}=oe(),V=re(),s=ce("switch");de({from:'"value"',replacement:'"model-value" or "v-model"',scope:d,version:"2.3.0",ref:"https://element-plus.org/en-US/component/switch.html#attributes",type:"Attribute"},U(()=>{var t;return!!((t=p.vnode.props)!=null&&t.value)}));const{inputId:E}=ue(o,{formItemContext:h}),g=me(U(()=>o.loading)),I=R(o.modelValue!==!1),k=R(),B=R(),y=U(()=>[s.b(),s.m(V.value),s.is("disabled",g.value),s.is("checked",f.value)]),u=U(()=>({width:he(o.width)}));K(()=>o.modelValue,()=>{I.value=!0}),K(()=>o.value,()=>{I.value=!1});const S=U(()=>I.value?o.modelValue:o.value),f=U(()=>S.value===o.activeValue);[o.activeValue,o.inactiveValue].includes(S.value)||(m(L,o.inactiveValue),m(M,o.inactiveValue),m(j,o.inactiveValue)),K(f,t=>{var b;k.value.checked=t,o.validateEvent&&((b=h==null?void 0:h.validate)==null||b.call(h,"change").catch(ie=>ve()))});const P=()=>{const t=f.value?o.inactiveValue:o.activeValue;m(L,t),m(M,t),m(j,t),Ne(()=>{k.value.checked=f.value})},W=()=>{if(g.value)return;const{beforeChange:t}=o;if(!t){P();return}const b=t();[X(b),F(b)].includes(!0)||fe(d,"beforeChange must return type `Promise<boolean>` or `boolean`"),X(b)?b.then(G=>{G&&P()}).catch(G=>{}):b&&P()},ae=U(()=>s.cssVarBlock({...o.activeColor?{"on-color":o.activeColor}:null,...o.inactiveColor?{"off-color":o.inactiveColor}:null,...o.borderColor?{"border-color":o.borderColor}:null})),se=()=>{var t,b;(b=(t=k.value)==null?void 0:t.focus)==null||b.call(t)};return Ie(()=>{k.value.checked=f.value}),i({focus:se,checked:f}),(t,b)=>(r(),v("div",{class:w(a(y)),style:J(a(ae)),onClick:Ue(W,["prevent"])},[D("input",{id:a(E),ref_key:"input",ref:k,class:w(a(s).e("input")),type:"checkbox",role:"switch","aria-checked":a(f),"aria-disabled":a(g),name:t.name,"true-value":t.activeValue,"false-value":t.inactiveValue,disabled:a(g),tabindex:t.tabindex,onChange:P,onKeydown:ee(W,["enter"])},null,42,Re),!t.inlinePrompt&&(t.inactiveIcon||t.inactiveText)?(r(),v("span",{key:0,class:w([a(s).e("label"),a(s).em("label","left"),a(s).is("active",!a(f))])},[t.inactiveIcon?(r(),C(a(N),{key:0},{default:c(()=>[(r(),C(z(t.inactiveIcon)))]),_:1})):_("v-if",!0),!t.inactiveIcon&&t.inactiveText?(r(),v("span",{key:1,"aria-hidden":a(f)},T(t.inactiveText),9,Ke)):_("v-if",!0)],2)):_("v-if",!0),D("span",{ref_key:"core",ref:B,class:w(a(s).e("core")),style:J(a(u))},[t.inlinePrompt?(r(),v("div",{key:0,class:w(a(s).e("inner"))},[t.activeIcon||t.inactiveIcon?(r(),v(q,{key:0},[t.activeIcon?(r(),C(a(N),{key:0,class:w([a(s).is("icon"),a(f)?a(s).is("show"):a(s).is("hide")])},{default:c(()=>[(r(),C(z(t.activeIcon)))]),_:1},8,["class"])):_("v-if",!0),t.inactiveIcon?(r(),C(a(N),{key:1,class:w([a(s).is("icon"),a(f)?a(s).is("hide"):a(s).is("show")])},{default:c(()=>[(r(),C(z(t.inactiveIcon)))]),_:1},8,["class"])):_("v-if",!0)],64)):t.activeText||t.inactiveIcon?(r(),v(q,{key:1},[t.activeText?(r(),v("span",{key:0,class:w([a(s).is("text"),a(f)?a(s).is("show"):a(s).is("hide")]),"aria-hidden":!a(f)},T(t.activeText.substring(0,3)),11,Le)):_("v-if",!0),t.inactiveText?(r(),v("span",{key:1,class:w([a(s).is("text"),a(f)?a(s).is("hide"):a(s).is("show")]),"aria-hidden":a(f)},T(t.inactiveText.substring(0,3)),11,Me)):_("v-if",!0)],64)):_("v-if",!0)],2)):_("v-if",!0),D("div",{class:w(a(s).e("action"))},[t.loading?(r(),C(a(N),{key:0,class:w(a(s).is("loading"))},{default:c(()=>[l(a(Fe))]),_:1},8,["class"])):_("v-if",!0)],2)],6),!t.inlinePrompt&&(t.activeIcon||t.activeText)?(r(),v("span",{key:1,class:w([a(s).e("label"),a(s).em("label","right"),a(s).is("active",a(f))])},[t.activeIcon?(r(),C(a(N),{key:0},{default:c(()=>[(r(),C(z(t.activeIcon)))]),_:1})):_("v-if",!0),!t.activeIcon&&t.activeText?(r(),v("span",{key:1,"aria-hidden":!a(f)},T(t.activeText),9,je)):_("v-if",!0)],2)):_("v-if",!0)],14,Ae))}});var We=pe(He,[["__file","/home/runner/work/element-plus/element-plus/packages/components/switch/src/switch.vue"]]);const Ge=_e(We),Qe={username:[{message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],password:[{message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],avatar_url:[{message:"\u5934\u50CF\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],before_expire_days:[{message:"\u8FC7\u671F\u524D\u591A\u5C11\u5929\u63D0\u9192\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],email_list:[{message:"\u90AE\u4EF6\u5217\u8868\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}]},Je={name:"",props:{row:{type:Object,default:null}},components:{},data(){return{rules:Qe,form:{username:"",password:"",avatar_url:"",before_expire_days:"",email_list:""}}},computed:{},methods:{async getData(){if(this.row){let n={id:this.row.id};const i=await this.$http.function(n);if(i.code!=0)return;let m=i.data;this.form.username=m.username,this.form.avatar_url=m.avatar_url,this.form.before_expire_days=m.before_expire_days,this.form.email_list=m.email_list}},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(n=>{if(n)this.confirmSubmit();else return!1})},async confirmSubmit(){let n=this.$loading({fullscreen:!0}),i={username:this.form.username,password:this.form.password};this.row&&(i.id=this.row.id);const m=await this.$http.addUser(i);m.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(m.msg),this.$nextTick(()=>{n.close()})}},created(){this.getData()}},Xe={class:"text-center"};function Ye(n,i,m,o,d,p){const h=Y,V=ge,s=be,E=Z;return r(),v("div",null,[l(s,{ref:"form",model:d.form,rules:d.rules,"label-width":"100px"},{default:c(()=>[l(V,{label:"\u7528\u6237\u540D",prop:"username"},{default:c(()=>[l(h,{type:"text",modelValue:d.form.username,"onUpdate:modelValue":i[0]||(i[0]=g=>d.form.username=g),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1}),l(V,{label:"\u5BC6\u7801",prop:"password"},{default:c(()=>[l(h,{type:"text",modelValue:d.form.password,"onUpdate:modelValue":i[1]||(i[1]=g=>d.form.password=g),placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),D("div",Xe,[l(E,{onClick:p.handleCancel},{default:c(()=>[H("\u53D6 \u6D88")]),_:1},8,["onClick"]),l(E,{type:"primary",onClick:p.handleSubmit},{default:c(()=>[H("\u786E \u5B9A")]),_:1},8,["onClick"])])])}const Ze=x(Je,[["render",Ye]]),et={name:"",props:{row:{type:Object,default:null},visible:{type:Boolean,default:!1}},emits:["update:visible"],components:{DataForm:Ze},data(){return{}},computed:{dialogTitle(){return this.row?"\u7F16\u8F91\u7528\u6237":"\u6DFB\u52A0\u7528\u6237"},dialogVisible:{get(){return this.visible},set(n){this.$emit("update:visible",n)}}},methods:{handleClose(){this.$emit("update:visible",!1)},handleOpen(){this.$emit("update:visible",!0)},handleSuccess(){this.handleClose(),this.$emit("on-success")}},created(){}};function tt(n,i,m,o,d,p){const h=O("DataForm"),V=we;return r(),C(V,{title:p.dialogTitle,modelValue:p.dialogVisible,"onUpdate:modelValue":i[0]||(i[0]=s=>p.dialogVisible=s),width:"400px",center:"","append-to-body":""},{default:c(()=>[p.dialogVisible?(r(),C(h,{key:0,row:m.row,onOnCancel:p.handleClose,onOnSuccess:p.handleSuccess},null,8,["row","onOnCancel","onOnSuccess"])):_("",!0)]),_:1},8,["title","modelValue"])}const te=x(et,[["render",tt]]);const at={name:"",components:{DataFormDailog:te},props:{list:{type:Array}},computed:{},data(){return{currentRow:null,dialogVisible:!1}},methods:{handleEditRow(n){this.currentRow=n,this.dialogVisible=!0},async handleDeleteClick(n){let i={user_id:n.id};(await this.$http.deleteUser(i)).code==0&&(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success"))},async handleStatusChange(n,i){let m={user_id:n.id,status:i};(await this.$http.updateUserStatus(m)).code==0&&this.$msg.success("\u64CD\u4F5C\u6210\u529F")},handleUpdateSuccess(){this.$emit("on-success")}},created(){}},st=D("img",{src:"https://api.multiavatar.com/domain-admin.png"},null,-1),it={key:1};function nt(n,i,m,o,d,p){const h=Se,V=ye,s=Ge,E=O("Delete"),g=N,I=De,k=ze,B=Ee,y=O("DataFormDailog");return r(),v("div",null,[l(B,{data:m.list,stripe:"",border:""},{default:c(()=>[l(h,{label:"ID",align:"center",prop:"id",width:"60"},{default:c(u=>[D("span",null,T(u.row.id||"-"),1)]),_:1}),l(h,{label:"\u7528\u6237\u540D","header-align":"center",align:"center",prop:"username"},{default:c(u=>[D("span",null,T(u.row.username||"-"),1)]),_:1}),l(h,{label:"\u5934\u50CF","header-align":"center",align:"center",prop:"avatar_url",width:"70"},{default:c(u=>[l(V,{src:u.row.avatar_url},{default:c(()=>[st]),_:2},1032,["src"])]),_:1}),l(h,{label:"\u8FC7\u671F\u524D\u591A\u5C11\u5929\u63D0\u9192","header-align":"center",align:"center",prop:"before_expire_days"},{default:c(u=>[D("span",null,T(u.row.before_expire_days||"-"),1)]),_:1}),l(h,{label:"\u90AE\u4EF6\u5217\u8868","header-align":"center",align:"center",prop:"email_list"},{default:c(u=>[u.row.email_list&&u.row.email_list.length>0?(r(!0),v(q,{key:0},Be(u.row.email_list,S=>(r(),v("div",null,T(S),1))),256)):(r(),v("span",it,"-"))]),_:1}),l(h,{label:"\u72B6\u6001","header-align":"center",align:"center",width:"80"},{default:c(u=>[l(s,{disabled:u.row.username=="admin",modelValue:u.row.status,"onUpdate:modelValue":S=>u.row.status=S,onChange:S=>p.handleStatusChange(u.row,S)},null,8,["disabled","modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(h,{label:"\u5220\u9664",width:"60",align:"center",prop:"tag"},{default:c(u=>[l(k,{title:"\u786E\u5B9A\u5220\u9664\uFF1F",onConfirm:S=>p.handleDeleteClick(u.row),disabled:u.row.username=="admin"},{reference:c(()=>[l(I,{disabled:u.row.username=="admin",underline:!1,type:"danger"},{default:c(()=>[l(g,null,{default:c(()=>[l(E)]),_:1})]),_:2},1032,["disabled"])]),_:2},1032,["onConfirm","disabled"])]),_:1})]),_:1},8,["data"]),l(y,{visible:d.dialogVisible,"onUpdate:visible":i[0]||(i[0]=u=>d.dialogVisible=u),row:d.currentRow,onOnSuccess:p.handleUpdateSuccess},null,8,["visible","row","onOnSuccess"])])}const lt=x(at,[["render",nt]]),ot={name:"user-admin-list",props:{},components:{DataFormDailog:te,DataTable:lt},data(){return{list:[],total:0,page:1,size:20,keyword:"",loading:!0,dialogVisible:!1}},computed:{},methods:{resetData(){this.page=1,this.getData()},refreshData(){this.getData()},async getData(){this.loading=!0;let n={page:this.page,size:this.size,keyword:this.keyword};const i=await this.$http.getUserList(n);i.code==0?(this.list=i.data.list,this.total=i.data.total):this.$msg.error(e.msg),this.loading=!1},handleAddRow(){this.dialogVisible=!0},handleAddSuccess(){this.resetData()},handleSearch(){this.resetData()}},created(){this.getData()}},rt={class:"app-container"},ct={class:"margin-bottom--20"};function dt(n,i,m,o,d,p){const h=Z,V=O("Search"),s=N,E=Y,g=O("DataTable"),I=ke,k=O("DataFormDailog"),B=Ce;return r(),v("div",rt,[D("div",ct,[l(h,{type:"primary",onClick:p.handleAddRow},{default:c(()=>[H("\u6DFB\u52A0")]),_:1},8,["onClick"]),l(E,{class:"ml-sm",style:{width:"260px"},modelValue:d.keyword,"onUpdate:modelValue":i[0]||(i[0]=y=>d.keyword=y),placeholder:"\u8F93\u5165\u7528\u6237\u540D",onKeypress:ee(p.handleSearch,["enter"])},{append:c(()=>[l(h,{onClick:p.handleSearch},{default:c(()=>[l(s,null,{default:c(()=>[l(V)]),_:1})]),_:1},8,["onClick"])]),_:1},8,["modelValue","onKeypress"])]),Pe(l(g,{class:"mt-md",list:d.list,onOnSuccess:p.resetData},null,8,["list","onOnSuccess"]),[[B,d.loading]]),l(I,{class:"mt-md justify-center",background:"",layout:"total, prev, pager, next",total:d.total,"page-size":d.size,"onUpdate:page-size":i[1]||(i[1]=y=>d.size=y),"current-page":d.page,"onUpdate:current-page":i[2]||(i[2]=y=>d.page=y),onCurrentChange:p.getData},null,8,["total","page-size","current-page","onCurrentChange"]),l(k,{visible:d.dialogVisible,"onUpdate:visible":i[3]||(i[3]=y=>d.dialogVisible=y),onOnSuccess:p.handleAddSuccess},null,8,["visible","onOnSuccess"])])}const bt=x(ot,[["render",dt]]);export{bt as default};
