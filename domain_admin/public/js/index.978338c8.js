import{ax as T,a5 as c,o as p,c as D,X as a,R as l,a as g,Z as u,Q as y,V as U,ay as R,az as B,aA as F,aB as q,at as N,aC as j}from"./vendor-vue.a1692e4d.js";import{Q as H}from"./element-icon.e40e8117.js";import{a as C,b as M}from"./vendor-lib.f70cdf99.js";import{E as v,i as K}from"./element-plus.4f78adc4.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const W={login:"/login",getDomainList:"/getDomainList",addDomain:"/addDomain",getDomainById:"/getDomainById",deleteDomainById:"/deleteDomainById",updateDomainById:"/updateDomainById",updateDomainCertInfoById:"/updateDomainCertInfoById",updateAllDomainCertInfoOfUser:"/updateAllDomainCertInfoOfUser",importDomainFromFile:"/importDomainFromFile",getAllDomainListOfUser:"/getAllDomainListOfUser",sendDomainInfoListEmail:"/sendDomainInfoListEmail",checkDomainCert:"/checkDomainCert",getAllSystemConfig:"/getAllSystemConfig",updateSystemConfig:"/updateSystemConfig",getUserInfo:"/getUserInfo",updateUserInfo:"/updateUserInfo",updateUserPassword:"/updateUserPassword",getUserList:"/getUserList",addUser:"/addUser",deleteUser:"/deleteUser",updateUserStatus:"/updateUserStatus",getLogSchedulerList:"/getLogSchedulerList"},k="token";function Pe(e){C.set(k,e,{expires:7})}function V(){return C.get(k)}function z(){C.remove(k)}const P="/api",E=M.create({baseURL:P});E.interceptors.request.use(e=>{let t=V();return t&&(e.headers["X-Token"]=t),e},e=>{console.log(e)});E.interceptors.response.use(e=>e.data,e=>{console.log(e)});function Q(e){return async function(t={},n){let i=null;t instanceof FormData,i=t;const s=await E.post(e,i,n);return s.code!=0&&v.error(s.msg),s}}function X(){let e={};for(let[t,n]of Object.entries(W))e[t]=Q(n);return e}const L=X();function Le(e){return P+e}class G{static message(t){return v.closeAll(),v(t)}static success(t){return this.message({message:t,type:"success"})}static warning(t){return this.message({message:t,type:"warning"})}static info(t){return this.message({message:t,type:"info"})}static error(t){return this.message({message:t,type:"error"})}static closeAll(){v.closeAll()}}const Y="modulepreload",Z=function(e){return"/"+e},S={},h=function(t,n,i){return!n||n.length===0?t():Promise.all(n.map(s=>{if(s=Z(s),s in S)return;S[s]=!0;const o=s.endsWith(".css"),r=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${r}`))return;const d=document.createElement("link");if(d.rel=o?"stylesheet":Y,o||(d.as="script",d.crossOrigin=""),d.href=s,document.head.appendChild(d),o)return new Promise((m,_)=>{d.addEventListener("load",m),d.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t())},b=T({id:"user-store",state:()=>({_userInfo:null}),getters:{hasUserInfo:e=>e._userInfo!=null,isAdmin:e=>{if(e._userInfo)return e._userInfo.username=="admin"},userInfo:e=>e._userInfo},actions:{async updateUserInfo(){const e=await L.getUserInfo();e.code==0&&(this._userInfo=e.data)},removeUserInfo(){this._userInfo=null}}}),J={password:[{message:"\u65E7\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],new_password:[{message:"\u65B0\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}]},I=(e,t)=>{const n=e.__vccOpts||e;for(const[i,s]of t)n[i]=s;return n},ee={name:"",props:{row:{type:Object,default:null}},components:{},data(){return{form:{password:"",new_password:""},rules:J}},computed:{},methods:{async getData(){if(this.row){let e={id:this.row.id};const t=await this.$http.function(e);if(t.code!=0)return;let n=t.data;this.form.password=n.password,this.form.new_password=n.new_password}},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(e=>{if(e)this.confirmSubmit();else return!1})},async confirmSubmit(){let e=this.$loading({fullscreen:!0}),t={password:this.form.password,new_password:this.form.new_password};const n=await this.$http.updateUserPassword(t);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg),this.$nextTick(()=>{e.close()})}},created(){this.getData()}},te={class:"text-center"};function se(e,t,n,i,s,o){const r=c("el-input"),d=c("el-form-item"),m=c("el-form"),_=c("el-button");return p(),D("div",null,[a(m,{ref:"form",model:s.form,rules:s.rules,"label-width":"80px"},{default:l(()=>[a(d,{label:"\u65E7\u5BC6\u7801",prop:"password"},{default:l(()=>[a(r,{type:"text",modelValue:s.form.password,"onUpdate:modelValue":t[0]||(t[0]=w=>s.form.password=w),placeholder:"\u8BF7\u8F93\u5165\u65E7\u5BC6\u7801"},null,8,["modelValue"])]),_:1}),a(d,{label:"\u65B0\u5BC6\u7801",prop:"new_password"},{default:l(()=>[a(r,{type:"text",modelValue:s.form.new_password,"onUpdate:modelValue":t[1]||(t[1]=w=>s.form.new_password=w),placeholder:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),g("div",te,[a(_,{onClick:o.handleCancel},{default:l(()=>[u("\u53D6 \u6D88")]),_:1},8,["onClick"]),a(_,{type:"primary",onClick:o.handleSubmit},{default:l(()=>[u("\u786E \u5B9A")]),_:1},8,["onClick"])])])}const oe=I(ee,[["render",se]]),ne={name:"",props:{row:{type:Object,default:null},visible:{type:Boolean,default:!1}},emits:["update:visible"],components:{DataForm:oe},data(){return{}},computed:{dialogTitle(){return this.row?"\u7F16\u8F91":"\u6DFB\u52A0"},dialogVisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}}},methods:{handleClose(){this.dialogVisible=!1},handleOpen(){},handleSuccess(){this.$emit("on-success")}},created(){}};function re(e,t,n,i,s,o){const r=c("DataForm"),d=c("el-dialog");return p(),y(d,{title:"\u4FEE\u6539\u767B\u5F55\u5BC6\u7801",modelValue:o.dialogVisible,"onUpdate:modelValue":t[0]||(t[0]=m=>o.dialogVisible=m),width:"400px",center:"","append-to-body":""},{default:l(()=>[o.dialogVisible?(p(),y(r,{key:0,row:n.row,onOnCancel:o.handleClose,onOnSuccess:o.handleSuccess},null,8,["row","onOnCancel","onOnSuccess"])):U("",!0)]),_:1},8,["modelValue"])}const ae=I(ne,[["render",re]]),ie={name:"Menu",props:{},components:{UserPaswordEditDataFormDailog:ae},data(){return{activeIndex:"",dialogVisible:!1}},computed:{...R(b,{userInfo:"userInfo",isAdmin:"isAdmin"})},methods:{...B(b,{updateUserInfo:"updateUserInfo",removeUserInfo:"removeUserInfo"}),async getData(){},handleSelect(e){},handleLogoutClick(e){this.removeUserInfo(),z(),this.$router.push({path:"/login"})},handleUpdatePasswordClick(){this.dialogVisible=!0},handleUserPaswordEditClose(){this.dialogVisible=!1},handleUserPaswordEditSuccess(){this.dialogVisible=!1}},created(){this.activeIndex=this.$route.name,this.getData()}},le={class:""},de={class:"self-center margin-left--auto flex items-center"},ce=g("a",{href:"https://github.com/mouday/domain-admin",class:"mr-md",target:"_blank"},[g("img",{alt:"GitHub stars",src:"https://img.shields.io/github/stars/mouday/domain-admin.svg?style=social"})],-1),ue=g("img",{src:"https://api.multiavatar.com/domain-admin.png"},null,-1);function me(e,t,n,i,s,o){const r=c("el-menu-item"),d=c("el-avatar"),m=c("el-dropdown-item"),_=c("el-dropdown-menu"),w=c("el-dropdown"),A=c("el-menu"),x=c("UserPaswordEditDataFormDailog");return p(),D("div",le,[a(A,{"default-active":s.activeIndex,ellipsis:!1,class:"el-menu-demo",mode:"horizontal",router:"","menu-trigger":"click",onSelect:o.handleSelect},{default:l(()=>[a(r,{index:"domain-list"},{default:l(()=>[u("\u57DF\u540D\u7BA1\u7406")]),_:1}),a(r,{index:"user-edit"},{default:l(()=>[u("\u4E2A\u4EBA\u8BBE\u7F6E")]),_:1}),e.isAdmin?(p(),y(r,{key:0,index:"user-admin-list"},{default:l(()=>[u("\u7528\u6237\u7BA1\u7406")]),_:1})):U("",!0),e.isAdmin?(p(),y(r,{key:1,index:"system-list"},{default:l(()=>[u("\u7CFB\u7EDF\u8BBE\u7F6E")]),_:1})):U("",!0),a(r,{index:"log-scheduler-list"},{default:l(()=>[u("\u76D1\u6D4B\u65E5\u5FD7")]),_:1}),g("div",de,[ce,a(w,{trigger:"hover"},{dropdown:l(()=>[a(_,null,{default:l(()=>[a(m,{onClick:o.handleUpdatePasswordClick,class:"justify-center"},{default:l(()=>[u("\u4FEE\u6539\u5BC6\u7801")]),_:1},8,["onClick"]),a(m,{onClick:o.handleLogoutClick,class:"justify-center"},{default:l(()=>[u("\u9000\u51FA")]),_:1},8,["onClick"])]),_:1})]),default:l(()=>[a(d,{src:e.userInfo&&e.userInfo.avatar_url},{default:l(()=>[ue]),_:1},8,["src"])]),_:1})])]),_:1},8,["default-active","onSelect"]),a(x,{visible:s.dialogVisible,"onUpdate:visible":t[0]||(t[0]=$=>s.dialogVisible=$),onOnSuccess:o.handleUserPaswordEditSuccess,onOnCancel:o.handleUserPaswordEditClose},null,8,["visible","onOnSuccess","onOnCancel"])])}const pe=I(ie,[["render",me]]);const fe={name:"index",props:{},components:{Menu:pe},data(){return{}},computed:{},methods:{async getData(){}},created(){this.getData()}},_e={class:"app-layout"};function he(e,t,n,i,s,o){const r=c("Menu"),d=c("router-view");return p(),D("div",_e,[a(r),g("div",null,[a(d)])])}const ge=I(fe,[["render",he]]),we=[{path:"/login",component:h(()=>import("./Login.a9b14c0b.js"),["js/Login.a9b14c0b.js","css/Login.17e414ed.css","js/vendor-vue.a1692e4d.js","js/element-icon.e40e8117.js","js/vendor-lib.f70cdf99.js","js/element-plus.4f78adc4.js"])},{path:"/",component:ge,redirect:"/domain-list",children:[{path:"/domain-list",name:"domain-list",component:()=>h(()=>import("./index.4ffbe7eb.js"),["js/index.4ffbe7eb.js","css/index.56d6aeba.css","js/vendor-vue.a1692e4d.js","js/ConnectStatus.cbda8d7a.js","js/vendor-lib.f70cdf99.js","js/element-plus.4f78adc4.js","js/element-icon.e40e8117.js"])},{path:"/system-list",name:"system-list",component:()=>h(()=>import("./index.bdb6c6b7.js"),["js/index.bdb6c6b7.js","js/vendor-vue.a1692e4d.js","js/element-icon.e40e8117.js","js/vendor-lib.f70cdf99.js","js/element-plus.4f78adc4.js"])},{path:"/user-edit",name:"user-edit",component:()=>h(()=>import("./index.e6beb7fb.js"),["js/index.e6beb7fb.js","js/vendor-vue.a1692e4d.js","js/element-icon.e40e8117.js","js/vendor-lib.f70cdf99.js","js/element-plus.4f78adc4.js"])},{path:"/user-admin-list",name:"user-admin-list",component:()=>h(()=>import("./index.146b1a8e.js"),["js/index.146b1a8e.js","js/vendor-vue.a1692e4d.js","js/element-icon.e40e8117.js","js/vendor-lib.f70cdf99.js","js/element-plus.4f78adc4.js"])},{path:"/log-scheduler-list",name:"log-scheduler-list",component:()=>h(()=>import("./index.f7194c01.js"),["js/index.f7194c01.js","js/ConnectStatus.cbda8d7a.js","js/vendor-vue.a1692e4d.js","js/element-icon.e40e8117.js","js/vendor-lib.f70cdf99.js","js/element-plus.4f78adc4.js"])}]}],ye=["/login"];function Ie(e){e.beforeEach(async(t,n,i)=>{let s=V();const o=b();s&&!o.hasUserInfo&&await o.updateUserInfo(),ye.includes(t.path)||o.hasUserInfo?i():i({path:"/login",query:{redirect:t.fullPath}})})}const O=F({history:q(),routes:we});Ie(O);const ve=O;const Ue={name:"app",props:{},components:{},data(){return{}},computed:{},methods:{},created(){}};function be(e,t,n,i,s,o){const r=c("router-view");return p(),y(r)}const De=I(Ue,[["render",be]]),f=N(De);f.config.globalProperties.$http=L;f.config.globalProperties.$msg=G;f.use(ve);f.use(K);for(const[e,t]of Object.entries(H))f.component(e,t);const Ce=j();f.use(Ce);f.mount("#app");export{I as _,W as d,Le as r,Pe as s,b as u};
